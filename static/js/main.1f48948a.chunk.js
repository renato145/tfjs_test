(this.webpackJsonptfjs_test=this.webpackJsonptfjs_test||[]).push([[0],{108:function(e,t){},109:function(e,t){},110:function(e,t){},111:function(e,t){},112:function(e,t){},113:function(e,t){},114:function(e,t,a){},117:function(e,t,a){},118:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(21),l=a.n(r),o=a(7),i=(a(99),a(125)),m=a(123),s=a(124),u=a(121),f=a(126),d=a(120),g=a(129),b=function(e){var t=e.className,a=e.defaultImg,r=e.imgURL,l=e.setImgURL,i=e.onChangeImage,m=e.disableButtons,s=void 0!==m&&m,f=Object(n.useRef)(),b=Object(n.useState)(a),p=Object(o.a)(b,2),h=p[0],E=p[1];return c.a.createElement(d.a,{className:t},c.a.createElement(g.a,{value:h,onChange:function(e){return E(e.target.value)},onClick:function(){return E("")},onBlur:function(){return E(r)},placeholder:"Image url","aria-label":"Image url"}),c.a.createElement(d.a.Append,null,c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){l(h),i()},disabled:s},"Load image url")),c.a.createElement(d.a.Append,null,c.a.createElement("input",{ref:f,type:"file",style:{display:"none"},accept:"image/*",onChange:function(e){var t=URL.createObjectURL(e.target.files[0]);l(t),E(t),i()}}),c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){return f.current.click()},disabled:s},"Upload image")))},p=a(68),h=a.n(p),E=a(122),v=Object(n.forwardRef)((function(e,t){var a=e.imgURL,n=e.heatmapURL,r=e.className;return c.a.createElement(c.a.Fragment,null,c.a.createElement(E.a,{crossOrigin:"anonymous",className:r,style:{display:n?"none":"inherit"},ref:t,src:a}),n&&c.a.createElement(h.a,{leftImage:a,leftImageCss:{position:"static"},rightImage:n,className:r}))})),j=a(69),y=a(16),O=a(33),k=parseInt(191.25),L=function(){var e=Object(n.useState)(),t=Object(o.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){j.a().then((function(e){c(e),console.log("model loaded")}))}),[]),a},N=a(128),I=function(e){var t=e.predictions,a=e.children;return c.a.createElement(c.a.Fragment,null,t&&c.a.createElement(N.a,{variant:"primary"},c.a.createElement("ol",null,t.map((function(e,t){return c.a.createElement("li",{key:t},e)}))),a))},R=(a(114),function(e){var t=e.heatmapLayers,a=e.onChange,r=Object(n.useMemo)((function(){var e=/.*MobilenetV1\/(.*)\/Relu6/;return t.map((function(t){return e.exec(t)[1]}))}),[t]);if(t)return c.a.createElement(m.a,{className:"justify-content-start"},c.a.createElement(s.a,{className:"col-auto"},c.a.createElement("label",{className:"selection-label mb-0 ml-2"},"Select heatmap layer"),c.a.createElement("select",{className:"custom-select",onChange:function(e){return a(+e.target.value)}},r.map((function(e,t){return c.a.createElement("option",{key:t,value:t},e)})))))}),C=a(127),U=function(e){var t=e.url,a="renato.hermoza@pucp.edu.pe";return c.a.createElement("footer",{style:{width:"100%"},className:"mt-5"},c.a.createElement("p",{style:{color:"#6c757d",paddingLeft:"1rem",marginBottom:"0rem",fontSize:"0.9rem"}},"Made by: Renato Hermoza, check the"," ",c.a.createElement("a",{href:"https://github.com/renato145/".concat(t),target:"_black"},"source code"),"."),c.a.createElement("hr",{className:"mt-2"}),c.a.createElement(C.a,{className:"justify-content-center"},c.a.createElement(C.a.Item,null,c.a.createElement(C.a.Link,{href:"mailto:".concat(a)},a)),c.a.createElement(C.a.Item,null,c.a.createElement(C.a.Link,{href:"https://twitter.com/".concat("renato145"),target:"_black"},"Twitter")),c.a.createElement(C.a.Item,null,c.a.createElement(C.a.Link,{href:"https://github.com/".concat("renato145"),target:"_black"},"GitHub")),c.a.createElement(C.a.Item,null,c.a.createElement(C.a.Link,{href:"https://".concat("renato145",".github.io"),target:"_black"},"Blog"))))},x=(a(117),"https://cdn.glitch.com/5bf7c54b-c36f-4009-a191-186909fb788e%2Fcat_flickr_publicdomain.jpg"),w=function(){var e=Object(n.useRef)(),t=Object(n.useState)(x),a=Object(o.a)(t,2),r=a[0],l=a[1],d=Object(n.useState)(),g=Object(o.a)(d,2),p=g[0],h=g[1],E=Object(n.useState)(),j=Object(o.a)(E,2),N=j[0],C=j[1],w=Object(n.useState)(0),_=Object(o.a)(w,2),B=_[0],S=_[1],z=L(),F=Object(n.useMemo)((function(){if(z)return function(e){return e.model.artifacts.modelTopology.node.filter((function(e){return e.name.includes("pointwise/Relu6")})).map((function(e){return e.name}))}(z)}),[z]),P=Object(n.useCallback)((function(t){if(F){var a,n=function(e){var t=e.model,a=e.x,n=e.layerName;return y.c((function(){var e=y.a.fromPixels(a),c=e.toFloat().mul(t.normalizationConstant).add(t.inputMin),r=c,l=e.shape;if(224!==e.shape[0]||224!==e.shape[1]){r=y.b.resizeBilinear(c,[224,224],!0)}var o=r.reshape([-1,224,224,3]),i=t.model.execute(o,n).mean([0,-1]);return(i=(i=i.sub(i.min())).div(i.max())).expandDims(-1).resizeBilinear(l.slice(0,2),!0)}))}({model:z,x:e.current,layerName:F[t]});(a=n,new Promise((function(e){var t=document.createElement("canvas");y.a.toPixels(a,t).then((function(){for(var a=t.getContext("2d"),n=a.getImageData(0,0,t.width,t.height),c=n.data,r=0;r<c.length/4;r++){var l=4*r,o=Object(O.a)(Object(O.b)(c[l]/255));c[l]=o.r,c[l+1]=o.g,c[l+2]=o.b,c[l+3]=k}a.putImageData(n,0,0),e(t.toDataURL())}))}))).then(h)}}),[F,z]);return c.a.createElement(i.a,null,c.a.createElement("header",null,c.a.createElement("h1",{className:"mt-4 mb-4"},"tfjs test")),c.a.createElement("main",null,c.a.createElement(b,{className:"mb-3",defaultImg:x,imgURL:r,setImgURL:l,onChangeImage:function(){h(void 0),C(void 0)},disableButtons:!z}),c.a.createElement(m.a,{className:"justify-content-center"},c.a.createElement(s.a,{lg:9},c.a.createElement(v,{className:"w-100 mb-2",imgURL:r,heatmapURL:p,ref:e}),!p&&c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"mb-2 ml-2"},c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){!function(e){var t=e.model,a=e.img,n=e.setPredictions;t.classify(a).then((function(e){console.log("Predictions:"),console.log(e);var t=e.map((function(e){return"".concat(e.className," (").concat(e.probability.toFixed(2),")")}));n(t)}))}({model:z,img:e.current,setPredictions:C}),P(B)},disabled:!z},z?"Classify this!":c.a.createElement(c.a.Fragment,null,"Loading model..."," ",c.a.createElement(f.a,{animation:"border",size:"sm"}))))),c.a.createElement(I,{predictions:N},c.a.createElement(R,{heatmapLayers:F,onChange:function(e){P(e),S(e)}}))))),c.a.createElement(U,{url:"tfjs_test"}))};l.a.render(c.a.createElement(w,null),document.getElementById("root"))},94:function(e,t,a){e.exports=a(118)}},[[94,1,2]]]);
//# sourceMappingURL=main.1f48948a.chunk.js.map