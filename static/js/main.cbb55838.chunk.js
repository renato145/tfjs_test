(this.webpackJsonptfjs_test=this.webpackJsonptfjs_test||[]).push([[0],{30:function(e,t,a){e.exports=a(51)},44:function(e,t){},45:function(e,t){},46:function(e,t){},47:function(e,t){},48:function(e,t){},49:function(e,t){},50:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),l=a(13),r=a.n(l),i=a(6),o=(a(35),a(56)),s=a(57),m=a(58),u=a(54),f=a(59),d=a(53),g=a(61),p=function(e){var t=e.className,a=e.defaultImg,l=e.setImgURL,r=e.onChangeImage,o=e.disableButtons,s=void 0!==o&&o,m=Object(n.useRef)(),f=Object(n.useState)(a),p=Object(i.a)(f,2),b=p[0],E=p[1];return c.a.createElement(d.a,{className:t},c.a.createElement(g.a,{value:b,onChange:function(e){return E(e.target.value)},onClick:function(){return E("")},placeholder:"Image url","aria-label":"Image url"}),c.a.createElement(d.a.Append,null,c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){l(b),r()},disabled:s},"Load image url")),c.a.createElement(d.a.Append,null,c.a.createElement("input",{ref:m,type:"file",style:{display:"none"},accept:"image/*",onChange:function(e){var t=URL.createObjectURL(e.target.files[0]);l(t),E(t),r()}}),c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){return m.current.click()},disabled:s},"Upload image")))},b=a(24),E=a.n(b),h=a(55),v=Object(n.forwardRef)((function(e,t){var a=e.imgURL,n=e.heatmapURL,l=e.className;return n?c.a.createElement(E.a,{leftImage:a,leftImageCss:{position:"static"},rightImage:n,className:l}):c.a.createElement(h.a,{crossOrigin:"anonymous",className:l,ref:t,src:a})})),j=a(25),O=a(11),R=function(e){var t=e.model,a=e.img,n=e.setPredictions,c=e.setHeatmapURL;t.classify(a).then((function(e){console.log("Predictions:"),console.log(e);var l=e.map((function(e){return"".concat(e.className," (").concat(e.probability.toFixed(2),")")}));n(l);var r,i=function(e){var t=e.model,a=e.x;return O.c((function(){var e=O.a.fromPixels(a),n=e.toFloat().mul(t.normalizationConstant).add(t.inputMin),c=n,l=e.shape;if(224!==e.shape[0]||224!==e.shape[1]){c=O.b.resizeBilinear(n,[224,224],!0)}var r=c.reshape([-1,224,224,3]),i=t.model.execute(r,"module_apply_default/MobilenetV1/MobilenetV1/Conv2d_13_pointwise/Relu6").mean([0,-1]);return(i=(i=i.sub(i.min())).div(i.max())).expandDims(-1).resizeBilinear(l.slice(0,2),!0)}))}({model:t,x:a});(r=i,new Promise((function(e){var t=document.createElement("canvas");O.a.toPixels(r,t).then((function(){for(var a=t.getContext("2d"),n=a.getImageData(0,0,t.width,t.height),c=n.data,l=0;l<c.length;l++)[1,2].includes(l%4)&&(c[l]=0),l%4===3&&(c[l]=127);a.putImageData(n,0,0),e(t.toDataURL())}))}))).then((function(e){return c(e)}))}))},y=function(){var e=Object(n.useState)(),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(n.useEffect)((function(){j.a().then((function(e){c(e),console.log("model loaded")}))}),[]),a},I=a(60),L=function(e){var t=e.predictions;return c.a.createElement(c.a.Fragment,null,t&&c.a.createElement(I.a,{variant:"primary"},c.a.createElement("ol",null,t.map((function(e,t){return c.a.createElement("li",{key:t},e)})))))},C=(a(50),"https://cdn.glitch.com/5bf7c54b-c36f-4009-a191-186909fb788e%2Fcat_flickr_publicdomain.jpg"),U=function(){var e=Object(n.useRef)(),t=Object(n.useState)(C),a=Object(i.a)(t,2),l=a[0],r=a[1],d=Object(n.useState)(),g=Object(i.a)(d,2),b=g[0],E=g[1],h=Object(n.useState)(),j=Object(i.a)(h,2),O=j[0],I=j[1],U=y();return c.a.createElement(o.a,null,c.a.createElement("header",null,c.a.createElement("h1",{className:"mt-4 mb-4"},"tfjs test")),c.a.createElement("main",null,c.a.createElement(p,{className:"mb-3",defaultImg:C,imgURL:l,setImgURL:r,onChangeImage:function(){E(void 0),I(void 0)},disableButtons:!U}),c.a.createElement(s.a,{className:"justify-content-center"},c.a.createElement(m.a,{lg:9},c.a.createElement(v,{className:"w-100 mb-2",imgURL:l,heatmapURL:b,ref:e}),!b&&c.a.createElement("div",{className:"mb-2 ml-2"},c.a.createElement(u.a,{variant:"outline-secondary",onClick:function(){return R({model:U,img:e.current,setPredictions:I,setHeatmapURL:E})},disabled:!U},U?"Classify this!":c.a.createElement(c.a.Fragment,null,"Loading model... ",c.a.createElement(f.a,{animation:"border",size:"sm"})))),c.a.createElement(L,{predictions:O})))),c.a.createElement("footer",null,c.a.createElement(s.a,null,c.a.createElement(m.a,{className:"mt-4 text-right"},c.a.createElement("a",{href:"https://github.com/renato145/tfjs_test",target:"_black"},"Source code")))))};r.a.render(c.a.createElement(U,null),document.getElementById("root"))}},[[30,1,2]]]);
//# sourceMappingURL=main.cbb55838.chunk.js.map